/*make this code return to 0xdeadbeef*/


#include <stdio.h>
#include <string.h>
#include <stdlib.h>

/*
crash
canary_copy
var
hi
buffer
canary
i
frame ptr
ret
shellcode
*/
typedef struct foo{
	int canary_copy;
	char crash[32];
	char var[32];
	int hi;
	char buffer[16];
	int canary;
	
	
	

}foo;

int main(int argc, char* argv[]){
	
	int i;
	foo fun;
	srand(time(0));	
	fun.canary=(0x41414141&0xffffff00)|(rand()%26+97);


	for(i=0; i<16; i++){
		fun.buffer[i]='0';
	}

	fun.hi=0x42424242;

	
	for(i=0; i<32; i++){
		fun.var[i]='0';
	}

	

	
	for(i=0; i<32; i++){
		fun.crash[i]='B';
	}	

	fun.canary_copy=fun.canary;

	
	
	printf("Please enter your first name\n");
	scanf("%s", &fun.var);
	printf(fun.var);
	printf("\nPlease enter your last name\n");
	scanf("%s", fun.buffer);


	
	
	if (fun.canary != fun.canary_copy){
		strcpy(fun.buffer,fun.crash);
	}
	return 0;
}
