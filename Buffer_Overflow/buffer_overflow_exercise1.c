#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(int argc, char* argv[]){
	if (argc != 2){
		printf("Usage: ./buffer_overflow_example1 <input>\n");
		return 0;  
	}
	char alphaNumeric[] = "1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
	char secretPassword[16];
	char buffer[16];
	
	srand(time(NULL));
	int i;
	/* creates super secure random password */
	for(i = 0; i < 15; i++){
		secretPassword[i] = alphaNumeric[rand() % (sizeof(alphaNumeric)-1)];
	}
	secretPassword[15] = '\0';
	printf("Randomly generated password is %s\n", secretPassword);
	
	strcpy(buffer, argv[1]);
	buffer[15] = '\0';
	secretPassword[15] = '\0';
	printf("Buffer   is %s\n", buffer);
	printf("Password is %s\n", secretPassword);
		
	if (strncmp(buffer, secretPassword, 15) == 0){
		printf("Access Granted\n");
	}
	else{
		printf("Access Denied\n");
	}
	return 0;
}
